<Page x:Class="Lebenslauf.Features.Cv.Presentation.CvPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:utu="using:Uno.Toolkit.UI"
      xmlns:controls="using:Lebenslauf.Core.Styles.Controls"
      Background="#FFFFFF">

    <Page.Resources>
        <!-- CLEAN CV DESIGN -->
        <Style x:Key="NameStyle" TargetType="TextBlock" BasedOn="{StaticResource DisplayLargeTextBlockStyle}">
            <Setter Property="FontSize" Value="64" />
            <Setter Property="FontWeight" Value="Black" />
            <Setter Property="Foreground" Value="#000000" />
            <Setter Property="CharacterSpacing" Value="-20" />
        </Style>
        <Style x:Key="RoleStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyMediumTextBlockStyle}">
            <Setter Property="Foreground" Value="#555555" />
            <Setter Property="CharacterSpacing" Value="80" />
            <Setter Property="FontSize" Value="11" />
        </Style>
        <Style x:Key="ContactStyle" TargetType="TextBlock" BasedOn="{StaticResource BodySmallTextBlockStyle}">
            <Setter Property="Foreground" Value="#666666" />
        </Style>
        <Style x:Key="LabelStyle" TargetType="TextBlock" BasedOn="{StaticResource LabelSmallTextBlockStyle}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="#666666" />
            <Setter Property="CharacterSpacing" Value="120" />
            <Setter Property="FontSize" Value="10" />
        </Style>
        <Style x:Key="SkillStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyMediumTextBlockStyle}">
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#000000" />
        </Style>
        <Style x:Key="YearStyle" TargetType="TextBlock" BasedOn="{StaticResource BodySmallTextBlockStyle}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="#000000" />
        </Style>
        <Style x:Key="TitleStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyMediumTextBlockStyle}">
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="Foreground" Value="#1A1A1A" />
        </Style>
        <Style x:Key="SubtitleStyle" TargetType="TextBlock" BasedOn="{StaticResource BodySmallTextBlockStyle}">
            <Setter Property="Foreground" Value="#555555" />
        </Style>
        <Style x:Key="DescStyle" TargetType="TextBlock" BasedOn="{StaticResource BodySmallTextBlockStyle}">
            <Setter Property="Foreground" Value="#444444" />
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>
        <Style x:Key="ProjectNameStyle" TargetType="TextBlock" BasedOn="{StaticResource LabelMediumTextBlockStyle}">
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="Foreground" Value="#000000" />
        </Style>
        <Style x:Key="ProjectDescStyle" TargetType="TextBlock" BasedOn="{StaticResource LabelSmallTextBlockStyle}">
            <Setter Property="Foreground" Value="#555555" />
            <Setter Property="TextWrapping" Value="Wrap" />
        </Style>
        <Style x:Key="BtnStyle" TargetType="Button" BasedOn="{StaticResource TransparentButtonStyle}" />
        <Style x:Key="RespStyle" TargetType="utu:ResponsiveView" />
    </Page.Resources>

    <Grid>
        <utu:ResponsiveView x:Name="CvContent" Style="{StaticResource RespStyle}">

        <!-- MOBILE -->
        <utu:ResponsiveView.NarrowTemplate>
            <DataTemplate>
                <ScrollViewer Background="#FFFFFF" Padding="24,32">
                    <StackPanel Spacing="32">

                        <!-- HEADER -->
                        <StackPanel Spacing="16">
                            <!-- Profilbild -->
                            <Border Width="100" Height="125" CornerRadius="4" HorizontalAlignment="Left">
                                <Border.Background>
                                    <ImageBrush ImageSource="ms-appx:///Assets/Images/profile.jpg" Stretch="UniformToFill" />
                                </Border.Background>
                            </Border>
                            <TextBlock Text="{Binding PersonalData.Name}" Style="{StaticResource NameStyle}" FontSize="40" />
                            <TextBlock Text="SENIOR CROSS-PLATFORM DEVELOPER" Style="{StaticResource RoleStyle}" />
                            <StackPanel Spacing="4" Margin="0,8,0,0">
                                <TextBlock Text="{Binding PersonalData.Email}" Style="{StaticResource ContactStyle}" />
                                <TextBlock Text="{Binding PersonalData.Phone}" Style="{StaticResource ContactStyle}" />
                            </StackPanel>
                        </StackPanel>

                        <Rectangle Height="1" Fill="#E0E0E0" />

                        <!-- EXPERTISE -->
                        <StackPanel Spacing="12">
                            <TextBlock Text="EXPERTISE" Style="{StaticResource LabelStyle}" />
                            <StackPanel Spacing="6">
                                <TextBlock Text="C# / .NET · XAML · MVVM" Style="{StaticResource SkillStyle}" />
                                <TextBlock Text="Uno Platform · Xamarin · MAUI" Style="{StaticResource SkillStyle}" />
                                <TextBlock Text="Cross-Platform · Mobile · Desktop" Style="{StaticResource SkillStyle}" />
                            </StackPanel>
                        </StackPanel>

                        <Rectangle Height="1" Fill="#E0E0E0" />

                        <!-- KARRIERE -->
                        <StackPanel Spacing="16">
                            <TextBlock Text="KARRIERE" Style="{StaticResource LabelStyle}" />
                            <ItemsRepeater ItemsSource="{Binding WorkExperience}">
                                <ItemsRepeater.Layout>
                                    <StackLayout Spacing="16" />
                                </ItemsRepeater.Layout>
                                <ItemsRepeater.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Spacing="4">
                                            <TextBlock Style="{StaticResource YearStyle}">
                                                <Run Text="{Binding StartDate.Year}" /><Run Text="—" /><Run Text="{Binding EndDate.Year, TargetNullValue='heute'}" />
                                            </TextBlock>
                                            <TextBlock Text="{Binding Role}" Style="{StaticResource TitleStyle}" />
                                            <TextBlock Text="{Binding Company}" Style="{StaticResource SubtitleStyle}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsRepeater.ItemTemplate>
                            </ItemsRepeater>
                        </StackPanel>

                        <Rectangle Height="1" Fill="#E0E0E0" />

                        <!-- PROJEKTE -->
                        <StackPanel Spacing="16">
                            <Button Command="{Binding NavigateToProjectsCommand}" Style="{StaticResource BtnStyle}">
                                <TextBlock Text="PROJEKTE →" Style="{StaticResource LabelStyle}" Foreground="#000000" />
                            </Button>
                            <ItemsRepeater ItemsSource="{Binding Projects}">
                                <ItemsRepeater.Layout>
                                    <StackLayout Spacing="12" />
                                </ItemsRepeater.Layout>
                                <ItemsRepeater.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Spacing="2">
                                            <TextBlock Text="{Binding Name}" Style="{StaticResource ProjectNameStyle}" />
                                            <TextBlock Text="{Binding Description}" Style="{StaticResource ProjectDescStyle}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsRepeater.ItemTemplate>
                            </ItemsRepeater>
                        </StackPanel>

                    </StackPanel>
                </ScrollViewer>
            </DataTemplate>
        </utu:ResponsiveView.NarrowTemplate>

        <!-- DESKTOP -->
        <utu:ResponsiveView.NormalTemplate>
            <DataTemplate>
                <ScrollViewer Background="#FFFFFF">
                    <StackPanel MaxWidth="1000" HorizontalAlignment="Center" Padding="48,48" Spacing="48">

                        <!-- ════════════════════════════════════════════════════════════════ -->
                        <!-- HEADER: Name links, Expertise rechts                              -->
                        <!-- ════════════════════════════════════════════════════════════════ -->
                        <Grid ColumnSpacing="32">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" MinWidth="200" />
                            </Grid.ColumnDefinitions>

                            <!-- Links: Bild + Name + Contact -->
                            <StackPanel Orientation="Horizontal" Spacing="24">
                                <!-- Profilbild -->
                                <Border Width="120" Height="150" CornerRadius="4">
                                    <Border.Background>
                                        <ImageBrush ImageSource="ms-appx:///Assets/Images/profile.jpg" Stretch="UniformToFill" />
                                    </Border.Background>
                                </Border>

                                <!-- Name + Info -->
                                <StackPanel Spacing="12" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding PersonalData.Name}" Style="{StaticResource NameStyle}" />
                                    <TextBlock Text="SENIOR CROSS-PLATFORM DEVELOPER" Style="{StaticResource RoleStyle}" />
                                    <StackPanel Orientation="Horizontal" Spacing="20" Margin="0,12,0,0">
                                        <TextBlock Text="{Binding PersonalData.Email}" Style="{StaticResource ContactStyle}" />
                                        <TextBlock Text="{Binding PersonalData.Phone}" Style="{StaticResource ContactStyle}" />
                                        <TextBlock Style="{StaticResource ContactStyle}">
                                            <Run Text="{Binding PersonalData.City}" /><Run Text=", " /><Run Text="{Binding PersonalData.Country}" />
                                        </TextBlock>
                                    </StackPanel>
                                </StackPanel>
                            </StackPanel>

                            <!-- Rechts: Expertise -->
                            <StackPanel Grid.Column="1" Spacing="12" VerticalAlignment="Bottom" HorizontalAlignment="Right">
                                <TextBlock Text="EXPERTISE" Style="{StaticResource LabelStyle}" />
                                <StackPanel Spacing="4">
                                    <TextBlock Text="C# / .NET · XAML · MVVM" Style="{StaticResource SkillStyle}" />
                                    <TextBlock Text="Uno Platform · Xamarin · MAUI" Style="{StaticResource SkillStyle}" />
                                    <TextBlock Text="Cross-Platform · Mobile · Desktop" Style="{StaticResource SkillStyle}" />
                                </StackPanel>
                            </StackPanel>
                        </Grid>

                        <!-- DIVIDER -->
                        <Rectangle Height="1" Fill="#000000" />

                        <!-- ════════════════════════════════════════════════════════════════ -->
                        <!-- KARRIERE + AUSBILDUNG nebeneinander                               -->
                        <!-- ════════════════════════════════════════════════════════════════ -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition Width="48" />
                                <ColumnDefinition Width="*" />
                            </Grid.ColumnDefinitions>

                            <!-- KARRIERE -->
                            <StackPanel Spacing="20">
                                <TextBlock Text="KARRIERE" Style="{StaticResource LabelStyle}" />
                                <ItemsRepeater ItemsSource="{Binding WorkExperience}">
                                    <ItemsRepeater.Layout>
                                        <StackLayout Spacing="24" />
                                    </ItemsRepeater.Layout>
                                    <ItemsRepeater.ItemTemplate>
                                        <DataTemplate>
                                            <Grid ColumnSpacing="16">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="80" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Style="{StaticResource YearStyle}">
                                                        <Run Text="{Binding StartDate.Year}" />
                                                    </TextBlock>
                                                    <TextBlock Style="{StaticResource SubtitleStyle}" FontSize="10">
                                                        <Run Text="{Binding EndDate.Year, TargetNullValue='heute'}" />
                                                    </TextBlock>
                                                </StackPanel>
                                                <StackPanel Grid.Column="1" Spacing="4">
                                                    <TextBlock Text="{Binding Role}" Style="{StaticResource TitleStyle}" />
                                                    <TextBlock Text="{Binding Company}" Style="{StaticResource SubtitleStyle}" />
                                                    <TextBlock Text="{Binding Description}" Style="{StaticResource DescStyle}" Margin="0,4,0,0" />
                                                </StackPanel>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsRepeater.ItemTemplate>
                                </ItemsRepeater>
                            </StackPanel>

                            <!-- AUSBILDUNG -->
                            <StackPanel Grid.Column="2" Spacing="20">
                                <TextBlock Text="AUSBILDUNG" Style="{StaticResource LabelStyle}" />
                                <ItemsRepeater ItemsSource="{Binding Education}">
                                    <ItemsRepeater.Layout>
                                        <StackLayout Spacing="20" />
                                    </ItemsRepeater.Layout>
                                    <ItemsRepeater.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Spacing="4">
                                                <TextBlock Style="{StaticResource YearStyle}">
                                                    <Run Text="{Binding StartYear}" /><Run Text="—" /><Run Text="{Binding EndYear}" />
                                                </TextBlock>
                                                <TextBlock Text="{Binding Degree}" Style="{StaticResource TitleStyle}" />
                                                <TextBlock Text="{Binding Institution}" Style="{StaticResource SubtitleStyle}" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsRepeater.ItemTemplate>
                                </ItemsRepeater>
                            </StackPanel>
                        </Grid>

                        <!-- DIVIDER -->
                        <Rectangle Height="1" Fill="#000000" />

                        <!-- ════════════════════════════════════════════════════════════════ -->
                        <!-- PROJEKTE als Grid                                                 -->
                        <!-- ════════════════════════════════════════════════════════════════ -->
                        <StackPanel Spacing="20">
                            <Button Command="{Binding NavigateToProjectsCommand}" Style="{StaticResource BtnStyle}">
                                <TextBlock Text="REFERENZPROJEKTE →" Style="{StaticResource LabelStyle}" Foreground="#000000" />
                            </Button>

                            <ItemsRepeater ItemsSource="{Binding Projects}">
                                <ItemsRepeater.Layout>
                                    <UniformGridLayout MinItemWidth="200" MinItemHeight="90" MinRowSpacing="16" MinColumnSpacing="16" MaximumRowsOrColumns="4" />
                                </ItemsRepeater.Layout>
                                <ItemsRepeater.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="#F8F8F8" Padding="16,14">
                                            <StackPanel Spacing="6">
                                                <TextBlock Text="{Binding Name}" Style="{StaticResource ProjectNameStyle}" />
                                                <TextBlock Text="{Binding Description}" Style="{StaticResource ProjectDescStyle}" MaxLines="2" />
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsRepeater.ItemTemplate>
                            </ItemsRepeater>
                        </StackPanel>

                    </StackPanel>
                </ScrollViewer>
            </DataTemplate>
        </utu:ResponsiveView.NormalTemplate>

    </utu:ResponsiveView>

        <!-- Floating PDF Export Button (rendered on top) -->
        <controls:ExportHeaderControl ExportTarget="{x:Bind CvContent}"
                                       FileName="Lebenslauf_Daniel_Hufnagl"
                                       Margin="0,16,48,0"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Top" />
    </Grid>
</Page>
