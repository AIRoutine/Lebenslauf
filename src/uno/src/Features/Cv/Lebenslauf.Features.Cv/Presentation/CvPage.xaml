<Page x:Class="Lebenslauf.Features.Cv.Presentation.CvPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Lebenslauf.Features.Cv.Presentation"
      xmlns:sections="using:Lebenslauf.Features.Cv.Presentation.Sections"
      xmlns:utu="using:Uno.Toolkit.UI"
      Background="{ThemeResource BackgroundBrush}">

    <Grid>
        <!-- Main CV Container -->
        <Border Background="{ThemeResource CardBrush}"
                CornerRadius="12"
                Margin="16"
                Padding="0"
                MaxWidth="1100"
                HorizontalAlignment="Center"
                VerticalAlignment="Stretch"
                Translation="0,0,16">
            <Border.Shadow>
                <ThemeShadow />
            </Border.Shadow>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <!-- Header Section -->
                <Border Padding="24,16"
                        BorderBrush="{ThemeResource BorderBrush}"
                        BorderThickness="0,0,0,1">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>

                        <!-- Profile Photo -->
                        <Border Width="80" Height="100"
                                CornerRadius="8"
                                Background="{ThemeResource SurfaceVariantBrush}">
                            <FontIcon Glyph="&#xE77B;"
                                      FontSize="48"
                                      Foreground="{ThemeResource OnSurfaceVariantBrush}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center" />
                        </Border>

                        <!-- Name and Contact -->
                        <StackPanel Grid.Column="1" Margin="24,0,0,0" VerticalAlignment="Center">
                            <!-- Name -->
                            <TextBlock Text="{Binding PersonalData.Name}"
                                       Style="{StaticResource CvNameTextBlockStyle}" />

                            <!-- Title -->
                            <TextBlock Text="Senior Cross-Platform Developer"
                                       Style="{StaticResource CvSubtitleTextBlockStyle}"
                                       Margin="0,4,0,16" />

                            <!-- Contact Row -->
                            <StackPanel Orientation="Horizontal" Spacing="24">
                                <!-- Email -->
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE715;" FontSize="14" Foreground="{ThemeResource OnSurfaceVariantBrush}" />
                                    <TextBlock Text="{Binding PersonalData.Email}"
                                               Style="{StaticResource CvContactTextBlockStyle}" />
                                </StackPanel>

                                <!-- Phone -->
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE717;" FontSize="14" Foreground="{ThemeResource OnSurfaceVariantBrush}" />
                                    <TextBlock Text="{Binding PersonalData.Phone}"
                                               Style="{StaticResource CvContactTextBlockStyle}" />
                                </StackPanel>

                                <!-- Location -->
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <FontIcon Glyph="&#xE81D;" FontSize="14" Foreground="{ThemeResource OnSurfaceVariantBrush}" />
                                    <TextBlock Style="{StaticResource CvContactTextBlockStyle}">
                                        <Run Text="{Binding PersonalData.City}" /><Run Text=", " /><Run Text="{Binding PersonalData.Country}" />
                                    </TextBlock>
                                </StackPanel>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>

                <!-- Two Column Content -->
                <Grid Grid.Row="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1.2*" />
                        <ColumnDefinition Width="1*" />
                    </Grid.ColumnDefinitions>

                    <!-- Left Column: Experience -->
                    <ScrollViewer Padding="20,16" VerticalScrollBarVisibility="Auto">
                        <StackPanel Spacing="16">

                            <!-- Experience Section -->
                            <StackPanel Spacing="10">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <Border Width="4" Height="18" CornerRadius="2" Background="{ThemeResource AccentBrush}" />
                                    <TextBlock Text="Berufserfahrung"
                                               Style="{StaticResource CvSectionHeaderTextBlockStyle}" />
                                </StackPanel>

                                <ItemsRepeater ItemsSource="{Binding WorkExperience}">
                                    <ItemsRepeater.Layout>
                                        <StackLayout Spacing="12" />
                                    </ItemsRepeater.Layout>
                                    <ItemsRepeater.ItemTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="16" />
                                                    <ColumnDefinition Width="*" />
                                                </Grid.ColumnDefinitions>

                                                <!-- Timeline Dot -->
                                                <Ellipse Width="8" Height="8"
                                                         Fill="{ThemeResource AccentBrush}"
                                                         VerticalAlignment="Top"
                                                         Margin="0,6,0,0" />

                                                <!-- Content -->
                                                <StackPanel Grid.Column="1" Spacing="4">
                                                    <Grid>
                                                        <TextBlock Text="{Binding Role}"
                                                                   Style="{StaticResource CvRoleTitleTextBlockStyle}" />
                                                        <TextBlock HorizontalAlignment="Right"
                                                                   Style="{StaticResource CvDateTextBlockStyle}">
                                                            <Run Text="{Binding StartDate.Year}" /><Run Text=" - " /><Run Text="{Binding EndDate.Year, TargetNullValue='Aktuell'}" />
                                                        </TextBlock>
                                                    </Grid>
                                                    <TextBlock Text="{Binding Company}"
                                                               Style="{StaticResource CvCompanyTextBlockStyle}" />
                                                    <TextBlock Text="{Binding Description}"
                                                               Style="{StaticResource CvDescriptionTextBlockStyle}"
                                                               Margin="0,4,0,0" />
                                                </StackPanel>
                                            </Grid>
                                        </DataTemplate>
                                    </ItemsRepeater.ItemTemplate>
                                </ItemsRepeater>
                            </StackPanel>

                            <!-- Education Section -->
                            <StackPanel Spacing="10">
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <Border Width="4" Height="18" CornerRadius="2" Background="{ThemeResource AccentBrush}" />
                                    <TextBlock Text="Ausbildung"
                                               Style="{StaticResource CvSectionHeaderTextBlockStyle}" />
                                </StackPanel>

                                <ItemsRepeater ItemsSource="{Binding Education}">
                                    <ItemsRepeater.Layout>
                                        <StackLayout Spacing="10" />
                                    </ItemsRepeater.Layout>
                                    <ItemsRepeater.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Spacing="2">
                                                <TextBlock Text="{Binding Degree}"
                                                           Style="{StaticResource CvRoleTitleTextBlockStyle}" />
                                                <TextBlock Text="{Binding Institution}"
                                                           Style="{StaticResource CvInstitutionAccentTextBlockStyle}" />
                                                <TextBlock Style="{StaticResource CvYearTextBlockStyle}">
                                                    <Run Text="{Binding StartYear}" /><Run Text=" - " /><Run Text="{Binding EndYear}" />
                                                </TextBlock>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsRepeater.ItemTemplate>
                                </ItemsRepeater>
                            </StackPanel>

                        </StackPanel>
                    </ScrollViewer>

                    <!-- Right Column: Skills & Projects -->
                    <Border Grid.Column="1"
                            Background="{ThemeResource SurfaceBrush}"
                            BorderBrush="{ThemeResource BorderBrush}"
                            BorderThickness="1,0,0,0">
                        <ScrollViewer Padding="16,12" VerticalScrollBarVisibility="Auto">
                            <StackPanel Spacing="16">

                                <!-- Technical Skills -->
                                <StackPanel Spacing="8">
                                    <Button Command="{Binding NavigateToSkillsCommand}"
                                            Style="{StaticResource TransparentButtonStyle}">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <FontIcon Glyph="&#xE74C;" FontSize="14" Foreground="{ThemeResource AccentBrush}" />
                                            <TextBlock Text="Technische Skills"
                                                       Style="{StaticResource TitleMediumTextBlockStyle}" />
                                            <FontIcon Glyph="&#xE76C;" FontSize="12" Foreground="{ThemeResource OnSurfaceVariantBrush}" VerticalAlignment="Center" />
                                        </StackPanel>
                                    </Button>

                                    <!-- Skill Bars -->
                                    <StackPanel Spacing="6">
                                        <sections:SkillBar SkillName="C# / .NET" Percentage="95" />
                                        <sections:SkillBar SkillName="XAML / MVVM" Percentage="90" />
                                        <sections:SkillBar SkillName="Uno Platform" Percentage="85" />
                                        <sections:SkillBar SkillName="Xamarin / MAUI" Percentage="90" />
                                        <sections:SkillBar SkillName="ASP.NET" Percentage="75" />
                                    </StackPanel>
                                </StackPanel>

                                <!-- Frameworks & Tools -->
                                <StackPanel Spacing="8">
                                    <StackPanel Orientation="Horizontal" Spacing="6">
                                        <FontIcon Glyph="&#xE713;" FontSize="14" Foreground="#10B981" />
                                        <TextBlock Text="Frameworks &amp; Tools"
                                                   Style="{StaticResource TitleMediumTextBlockStyle}" />
                                    </StackPanel>

                                    <ItemsRepeater ItemsSource="{Binding Frameworks}">
                                        <ItemsRepeater.Layout>
                                            <FlowLayout MinRowSpacing="4" MinColumnSpacing="4" />
                                        </ItemsRepeater.Layout>
                                        <ItemsRepeater.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="{ThemeResource SurfaceVariantBrush}"
                                                        CornerRadius="4"
                                                        Padding="10,5">
                                                    <TextBlock Text="{Binding}"
                                                               Style="{StaticResource CvChipTextBlockStyle}" />
                                                </Border>
                                            </DataTemplate>
                                        </ItemsRepeater.ItemTemplate>
                                    </ItemsRepeater>
                                </StackPanel>

                                <!-- Projects -->
                                <StackPanel Spacing="8">
                                    <Button Command="{Binding NavigateToProjectsCommand}"
                                            Style="{StaticResource TransparentButtonStyle}">
                                        <StackPanel Orientation="Horizontal" Spacing="6">
                                            <FontIcon Glyph="&#xE8A1;" FontSize="14" Foreground="#F59E0B" />
                                            <TextBlock Text="Referenz-Projekte"
                                                       Style="{StaticResource TitleMediumTextBlockStyle}" />
                                            <FontIcon Glyph="&#xE76C;" FontSize="12" Foreground="{ThemeResource OnSurfaceVariantBrush}" VerticalAlignment="Center" />
                                        </StackPanel>
                                    </Button>

                                    <ItemsRepeater ItemsSource="{Binding Projects}">
                                        <ItemsRepeater.Layout>
                                            <StackLayout Spacing="6" />
                                        </ItemsRepeater.Layout>
                                        <ItemsRepeater.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Spacing="2">
                                                    <TextBlock Text="{Binding Name}"
                                                               Style="{StaticResource CvProjectNameTextBlockStyle}" />
                                                    <TextBlock Text="{Binding Description}"
                                                               Style="{StaticResource CvProjectDescriptionTextBlockStyle}" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsRepeater.ItemTemplate>
                                    </ItemsRepeater>
                                </StackPanel>

                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                </Grid>
            </Grid>
        </Border>
    </Grid>
</Page>
